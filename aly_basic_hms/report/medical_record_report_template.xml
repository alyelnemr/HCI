<?xml version="1.0" encoding="utf-8"?>
<odoo>
        <template id="medical_record_report">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="doc">
                        <t t-if="doc.company_id.header">
                            <div class="header">
                                <t t-set="company" t-value="doc.company_id"></t>
                                <div class="row mt32 mb32">
                                    <div class="col-6">
                                        <img t-att-src="'data:image/png;base64,%s' % to_text(company.header)"
                                             />
                                    </div>
                                </div>
                            </div>
                        </t>
                        <t t-call="web.internal_layout">
                            <table class="table table-sm text-center" style="width:100%;border: 1px double black;">
                                <tr >
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">
                                        Patient Name
                                    </th>
                                    <td colspan="3">
                                        <b><span t-field="doc.patient_id.name" class="text-center"/></b>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Date of Birth</th>
                                    <td>
                                        <span t-field="doc.date_of_birth" class="text-center"/>
                                    </td>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Nationality</th>
                                    <td>
                                        <span t-field="doc.nationality_id.name" class="text-center"/>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Sex</th>
                                    <td>
                                        <span t-field="doc.sex" class="text-center"/>
                                    </td>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Hospital Ref#</th>
                                    <td>
                                        <span t-field="doc.our_reference" class="text-center"/>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Insurance Company</th>
                                    <td>
                                        <span t-field="doc.insurance_company_id.name" class="text-center"/>
                                    </td>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Insurance Ref#</th>
                                    <td>
                                        <span t-field="doc.insurance_reference" class="text-center"/>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Hotel</th>
                                    <td>
                                        <span t-field="doc.hotel.name" class="text-center"/>
                                    </td>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Room</th>
                                    <td>
                                        <span t-field="doc.room_number" class="text-center"/>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Arrival</th>
                                    <td>
                                        <span t-field="doc.date_of_arrival" class="text-center"/>
                                    </td>
                                    <th style="background-color:MediumSlateBlue !important;color:#FFF !important;">Departure</th>
                                    <td>
                                        <span t-field="doc.date_of_departure" class="text-center"/>
                                    </td>
                                </tr>
                                <br/>
                            </table>
                            <div>
                                <div>
                                    <h3 class="text-center"><strong>Final Medical Report</strong></h3>
                                    <t t-set="getadd" t-value="doc.get_sorting()"/>
                                    <!--<span t-esc="getadd"/>-->
                                </div>
                                <br/>
                                <div>
                                    <table style="width:100%">
                                        <tbody class="sale_tbody" style="width:100%">
                                            <tr>
                                                <td style="width:20%">Patient Complaint:</td>
                                                <td style="width:80%;">
                                                    <span t-field="doc.patient_complaint" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">Food &amp; Drug Allergy:</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.food_drug_allergy" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">History of Present Illness (HPI):</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.history_present_illness" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">Past medical History (PMH):</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.past_medical_history" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">Past surgical History (PSH):</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.past_surgical_history" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">Family History (FH):</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.family_history" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:20%">Social History (SH):</td>
                                                <td style="width:80%">
                                                    <span t-field="doc.social_history" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <t t-if="doc.update_note_ids">
                                        <br/>
                                        <br/>
                                        <div>
                                            <h4 class="text-center"><strong>Update Notes</strong></h4>
                                        </div>
                                        <t t-set="counter" t-value="0" />
                                        <t t-foreach="doc.update_note_ids.sorted(key=lambda a:(a.appointment_date))" t-as="app">
                                            <t t-set="counter" t-value="counter+1" />
                                            <br/>
                                            <div class="text-center">
                                                <h5>Update Note: <span t-esc="counter" /></h5>
                                                <span t-field="app.appointment_date" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                            </div>
                                            <div class="text-left">
                                                <strong>Vital Data</strong>
                                            </div>
                                            <br/>
                                            <table style="width:100%">
                                                <tbody class="sale_tbody">
                                                    <tr>
                                                        <td style="width:30%">Blood Pressure:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="app.vital_bp" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Temperature:</td>
                                                        <td>
                                                            <span t-field="app.vital_temp" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Pulse:</td>
                                                        <td>
                                                            <span t-field="app.vital_pulse" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Respiratory Rate:</td>
                                                        <td>
                                                            <span t-field="app.vital_rr" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Oxygen Sat.:</td>
                                                        <td>
                                                            <span t-field="app.vital_oxygen" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div>
                                                <br/>
                                                <br/>
                                                <div class="text-left">
                                                    <strong>Physical Examination</strong>
                                                </div>
                                                <br/>
                                                <table style="width:100%">
                                                    <tbody class="sale_tbody">
                                                        <tr>
                                                            <td style="width:30%">General Appearance:</td>
                                                            <td style="width:70%;">
                                                                <span t-field="app.general_appearance" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Head &amp; Neck:</td>
                                                            <td>
                                                                <span t-field="app.head_neck" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Chest:</td>
                                                            <td>
                                                                <span t-field="app.chest" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Abdomen:</td>
                                                            <td>
                                                                <span t-field="app.heart" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Extremities:</td>
                                                            <td>
                                                                <span t-field="app.extremities" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Neurological Examination:</td>
                                                            <td>
                                                                <span t-field="app.neurological_examination" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <t t-if="app.appointment_investigations_ids">
                                                <br/>
                                                <br/>
                                                <div class="text-left">
                                                    <strong>Investigations</strong>
                                                </div>
                                                <t t-set="counter_inv" t-value="0" />
                                                <t t-foreach="app.appointment_investigations_ids" t-as="inv">
                                                    <t t-set="counter_inv" t-value="counter_inv+1" />
                                                    <table>
                                                        <tbody class="sale_tbody">
                                                            <tr>
                                                                <td style="width:50%">
                                                                    <span t-esc="counter_inv" />.
                                                                    <span t-field="inv.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                </td>
                                                                <td style="width:50%;">
                                                                    <span t-field="inv.short_comment" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </t>
                                            </t>
                                            <t t-if="app.appointment_procedure_ids">
                                                <br/>
                                                <br/>
                                                <div class="text-left">
                                                    <strong>Procedures</strong>
                                                </div>
                                                <t t-set="counter_inv" t-value="0" />
                                                <t t-foreach="app.appointment_procedure_ids" t-as="inv">
                                                    <t t-set="counter_inv" t-value="counter_inv+1" />
                                                    <table>
                                                        <tbody class="sale_tbody">
                                                            <tr>
                                                                <td style="width:50%">
                                                                    <span t-esc="counter_inv" />.
                                                                    <span t-field="inv.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                </td>
                                                                <td style="width:50%;">
                                                                    <span t-field="inv.short_comment" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </t>
                                            </t>
                                            <t t-if="app.accommodation_id">
                                                <br/>
                                                <br/>
                                                <div class="text-left">
                                                    <strong>Management</strong>
                                                </div>
                                                <br/>
                                                <div class="text-left">
                                                    <span  style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;">
                                                        The patient has been admitted in <strong><span t-field="app.admission_type" /></strong>
                                                        under complete monitoring &amp;
                                                        observation, preparation for operation and is receiving the following treatment:
                                                    </span>
                                                </div>
                                            </t>
                                            <t t-if="app.medication_ids">
                                                <table style="width: 100%">
                                                    <tbody class="sale_tbody">
                                                    <t t-set="counter_medication" t-value="0" />
                                                    <t t-foreach="app.medication_ids" t-as="med">
                                                        <tr>
                                                            <td style="width:100%">
                                                                <t t-set="counter_medication" t-value="counter_medication+1" />
                                                                <t t-esc="counter_medication" />.
                                                                <span t-field="med.medical_medicament_id.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                  </tbody>
                                                </table>
                                                <br/>
                                                <br/>
                                            </t>
                                            <t t-if="app.recommendation">
                                                <div class="text-left">
                                                    <strong>Recommendations</strong>
                                                </div>
                                                <br/>
                                                <table>
                                                    <tbody class="sale_tbody">
                                                        <tr>
                                                            <td style="width:100%">
                                                                <span t-field="app.recommendation" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                            </td>
                                                        </tr>
                                                  </tbody>
                                                </table>
                                            </t>
                                        </t>
                                    </t>




                                    <t t-if="doc.inpatient_ids">
                                        <br/>
                                        <br/>
                                        <div>
                                            <h4 class="text-center"><strong>Inpatient</strong></h4>
                                        </div>
                                        <br/>
                                        <div class="text-left">
                                            <strong>Patient Admission</strong>
                                        </div>
                                        <br/>
                                        <t t-foreach="doc.inpatient_ids.sorted(key=lambda a:(a.admission_date))" t-as="inp">
                                            <table>
                                                <tbody class="sale_tbody">
                                                    <tr>
                                                        <td style="width:40%">Admission Date:</td>
                                                        <td style="width:60%;">
                                                            <span t-field="inp.admission_date" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:40%">Discharge Date:</td>
                                                        <td style="width:60%">
                                                            <span t-field="inp.discharge_datetime" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:40%">Admission Duration:</td>
                                                        <td style="width:60%">
                                                            <span t-field="inp.admission_days" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:40%">Discharge Basis:</td>
                                                        <td style="width:60%">
                                                            <span t-field="inp.discharge_basis" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:40%">Transportation:</td>
                                                        <td style="width:60%">
                                                            <span t-field="inp.transportation" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:20%">Discharge Recommendations:</td>
                                                        <td style="width:80%">
                                                            <span t-field="inp.recommendation" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <br/>
                                            <br/>
                                            <div>
                                                <h4 class="text-center"><strong>Inpatient Update Notes</strong></h4>
                                            </div>
                                            <br/>
                                            <t t-if="inp.inpatient_update_note_ids">
                                                <t t-set="counter_inp_note" t-value="0" />
                                                <t t-foreach="inp.inpatient_update_note_ids" t-as="inp_note">
                                                    <t t-set="counter_inp_note" t-value="counter_inp_note+1" />
                                                    <div class="text-center">
                                                        <h5>Update Note: <span t-esc="counter_inp_note" /></h5>
                                                        <span t-field="inp_note.update_note_date" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                    </div>
                                                    <div class="text-left">
                                                        <strong>Services &amp; Procedures</strong>
                                                    </div>
                                                    <t t-set="counter_inp_note_ser" t-value="0" />
                                                    <t t-foreach="inp_note.inpatient_line_ids" t-as="inp_note_ser">
                                                        <t t-set="counter_inp_note_ser" t-value="counter_inp_note_ser+1" />
                                                        <table>
                                                            <tbody class="sale_tbody">
                                                                <tr>
                                                                    <td style="width:50%">
                                                                        <span t-esc="counter_inp_note_ser" />.
                                                                        <span t-field="inp_note_ser.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                    </td>
                                                                    <td style="width:50%;">
                                                                        <span t-field="inp_note_ser.short_comment" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </t>
                                                    <t t-if="inp_note.admission_type_management">
                                                        <br/>
                                                        <br/>
                                                        <div class="text-left">
                                                            <span  style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;">
                                                                The patient has been admitted in <strong><span t-field="inp_note.admission_type_management" /></strong>
                                                            </span>
                                                        </div>
                                                    </t>
                                                    <t t-if="inp_note.medication_ids">
                                                        <br/>
                                                        <br/>
                                                        <div class="text-left">
                                                            <strong>Inpatient Medication</strong>
                                                        </div>
                                                        <table>
                                                            <tbody class="sale_tbody">
                                                                <t t-set="counter_medication" t-value="0" />
                                                                <t t-foreach="inp_note.medication_ids" t-as="med">
                                                                    <tr>
                                                                        <td style="width:100%">
                                                                            <t t-set="counter_medication" t-value="counter_medication+1" />
                                                                            <t t-esc="counter_medication" />.
                                                                            <span t-field="med.medical_medicament_id.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                        </td>
                                                                    </tr>
                                                                </t>
                                                            </tbody>
                                                        </table>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                    </t>





                                    <t t-if="doc.operation_ids">
                                        <br/>
                                        <br/>
                                        <div>
                                            <h4 class="text-center"><strong>Operations</strong></h4>
                                        </div>
                                        <t t-foreach="doc.operation_ids.sorted(key=lambda a:(a.time_in))" t-as="op" >
                                            <table>
                                                <tbody class="sale_tbody">
                                                    <tr>
                                                        <td style="width:30%">Time In:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.time_in" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Time Out:</td>
                                                        <td style="width:70%">
                                                            <span t-field="op.time_in" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Type of Anesthesia:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.type_of_anesthesia" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Operative Report:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.notes" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Monitoring:</td>
                                                        <td style="width:70%">
                                                            <span t-field="op.monitoring" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Induction:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.induction" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Maintenance:</td>
                                                        <td style="width:70%">
                                                            <span t-field="op.maintenance" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Hemodynamic Status:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.hemodynamic_status" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Blood Loss:</td>
                                                        <td style="width:70%">
                                                            <span t-field="op.blood_loss" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Recovery:</td>
                                                        <td style="width:70%;">
                                                            <span t-field="op.recovery" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:30%">Further Note:</td>
                                                        <td style="width:70%">
                                                            <span t-field="op.further_note" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <t t-if="op.operation_line_ids">
                                                <div class="text-left">
                                                    <strong>Post Operative Investigations</strong>
                                                </div>
                                                <table>
                                                    <tbody class="sale_tbody">
                                                        <t t-set="counter_medication" t-value="0"></t>
                                                        <t t-foreach="op.operation_line_ids" t-as="med">
                                                            <tr>
                                                                <td style="width:100%">
                                                                    <t t-set="counter_medication" t-value="counter_medication+1" />
                                                                    <t t-esc="counter_medication" />.
                                                                    <span t-field="med.product_id.name" style="font-size: 13px;font-family: Verdana, sans-serif;font-weight: normal;"/>
                                                                </td>
                                                            </tr>
                                                        </t>
                                                    </tbody>
                                                </table>
                                                <br/>
                                                <br/>
                                            </t>
                                        </t>
                                        <br/>
                                    </t>

                                </div>
                            </div>
                        </t>
                        <t t-if="doc.company_id.footer" >
                            <div class="footer">
                                <t t-set="company" t-value="doc.company_id"></t>
                                <div class="row mt32 mb32">
                                    <div class="col-6">
                                        <img t-att-src="'data:image/png;base64,%s' % to_text(company.footer)"
                                             />
                                    </div>
                                </div>
                            </div>
                        </t>
                    </t>
                </t>
        </template>
</odoo>
